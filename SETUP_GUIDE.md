# 🚀 설정 가이드 (Setup Guide)

## Google Apps Script 설정 (필수)

### 1단계: Google Apps Script 프로젝트 생성

1. [Google Apps Script](https://script.google.com/) 접속
2. "새 프로젝트" 클릭
3. 프로젝트 이름 설정 (예: "PageGenie API Proxy")

### 2단계: 코드 복사 및 붙여넣기

1. 프로젝트의 `Code.gs` 파일 열기
2. `GOOGLE_APPS_SCRIPT_CODE.js` 파일의 **전체 내용**을 복사
3. `Code.gs`의 기존 내용을 모두 삭제하고 붙여넣기

### 3단계: API 키 설정 (중요!)

1. 왼쪽 메뉴에서 **"프로젝트 설정"** (톱니바퀴 아이콘) 클릭
2. **"스크립트 속성"** 섹션으로 스크롤
3. **"스크립트 속성 추가"** 클릭
4. 다음 정보 입력:
   - **속성**: `GEMINI_API_KEY`
   - **값**: Google AI Studio에서 발급받은 Gemini API 키
     - [Google AI Studio](https://makersuite.google.com/app/apikey)에서 API 키 발급
5. **저장** 클릭

### 4단계: 웹 앱으로 배포

1. 상단 메뉴에서 **"배포"** → **"새 배포"** 클릭
2. **"유형 선택"** 옆의 톱니바퀴 아이콘 클릭
3. **"웹 앱"** 선택
4. 배포 설정:
   - **설명**: "PageGenie API Proxy" (선택사항)
   - **실행 대상**: "나"
   - **액세스 권한**: "모든 사용자" 또는 "나"
5. **"배포"** 클릭
6. **권한 승인**:
   - "권한 확인" 클릭
   - Google 계정 선택
   - "고급" → "안전하지 않은 페이지로 이동" (필요시)
   - "허용" 클릭
7. **웹 앱 URL 복사**:
   - 배포 완료 후 표시되는 URL을 복사
   - 예: `https://script.google.com/macros/s/AKfycb.../exec`

### 5단계: 애플리케이션에 URL 등록

1. 애플리케이션 실행
2. 우측 상단의 **설정 아이콘** (⚙️) 클릭
3. **"구글 시트 연동"** 탭 선택
4. **"Google Apps Script (GAS) Web App URL"** 필드에 복사한 URL 붙여넣기
5. **"설정 저장하기"** 클릭

---

## 환경 변수 설정 (선택사항 - GAS 대신 사용)

GAS 프록시를 사용하지 않고 직접 API 키를 사용하려면:

1. 프로젝트 루트에 `.env` 파일 생성
2. 다음 내용 추가:
   ```
   VITE_GEMINI_API_KEY=your_api_key_here
   ```
3. 애플리케이션 재시작

⚠️ **주의**: 이 방법은 API 키가 클라이언트에 노출되므로 보안상 권장하지 않습니다.

---

## Google Sheet ID 설정 (선택사항)

데이터를 Google Sheet에 저장하려면:

1. Google Sheets에서 새 스프레드시트 생성
2. URL에서 Sheet ID 복사:
   - URL 형식: `https://docs.google.com/spreadsheets/d/[SHEET_ID]/edit`
   - `[SHEET_ID]` 부분만 복사
3. 애플리케이션 설정에서 **"Google Sheet ID"** 필드에 입력
4. **"설정 저장하기"** 클릭

---

## 프리뷰 화면 확인 방법

### 개발 모드에서 확인

1. 터미널에서 다음 명령어 실행:
   ```bash
   npm run dev
   ```
2. 브라우저에서 자동으로 열리거나, 표시된 URL 접속 (기본: `http://localhost:3000`)
3. 프리뷰 화면은 **"상세페이지 생성 완료"** 단계에서 확인 가능

### 프리뷰 화면 위치

프리뷰는 다음 경로에서 확인할 수 있습니다:

1. **애플리케이션 실행** → 상품 이미지 업로드 → AI 분석 → **"상세페이지 생성 시작"** 클릭
2. 생성 완료 후 **"상세페이지 생성 완료"** 화면에서:
   - **왼쪽 패널**: 실시간 프리뷰 (스크롤 가능)
   - **오른쪽 패널**: 생성된 이미지 에셋

### 프리뷰 기능

- ✅ 실시간 미리보기
- ✅ 반응형 레이아웃 확인
- ✅ 이미지 재생성 (각 섹션별)
- ✅ HTML 다운로드
- ✅ ZIP 패키지 다운로드 (이미지 포함)

---

## 문제 해결

### API 키 오류
- **증상**: "Gemini API 키가 설정되지 않았습니다" 오류
- **해결**: 
  1. GAS 스크립트 속성에 `GEMINI_API_KEY`가 올바르게 설정되었는지 확인
  2. GAS 웹 앱 URL이 올바르게 입력되었는지 확인
  3. 또는 `.env` 파일에 `VITE_GEMINI_API_KEY` 설정

### CORS 오류
- **증상**: "Failed to fetch" 또는 CORS 관련 오류
- **해결**: 
  1. GAS 배포 시 "액세스 권한"을 "모든 사용자"로 설정
  2. GAS 코드의 `doOptions` 함수가 올바르게 구현되었는지 확인

### 이미지 업로드 실패
- **증상**: 이미지가 업로드되지 않음
- **해결**: 
  1. 이미지 크기 확인 (자동 최적화되지만 너무 큰 경우 문제 가능)
  2. 브라우저 콘솔에서 에러 메시지 확인

---

## 체크리스트

설정 완료 확인:

- [ ] Google Apps Script 프로젝트 생성
- [ ] `GOOGLE_APPS_SCRIPT_CODE.js` 코드 복사 및 붙여넣기
- [ ] 스크립트 속성에 `GEMINI_API_KEY` 설정
- [ ] 웹 앱으로 배포 완료
- [ ] 웹 앱 URL 복사
- [ ] 애플리케이션 설정에 GAS URL 입력
- [ ] Google Sheet ID 설정 (선택사항)
- [ ] 테스트: 이미지 업로드 및 분석 실행

---

## 추가 정보

- **GAS 실행 시간 제한**: 6분 (일반적으로 충분함)
- **API 호출 제한**: Google AI Studio의 할당량 확인
- **비용**: Gemini API 사용량에 따라 과금 (무료 티어 제공)

